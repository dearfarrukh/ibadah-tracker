<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<title>Ibadah Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<link rel="apple-touch-icon" href="icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">

<style>

body{
font-family:-apple-system,BlinkMacSystemFont,"San Francisco",system-ui;
background:url("wallpaper.jpg") center/cover no-repeat fixed;
margin:0;
padding:
env(safe-area-inset-top)
16px
calc(env(safe-area-inset-bottom)+20px)
16px;
}

h1{
text-align:center;
font-size:34px;
font-weight:700;
margin-bottom:10px;
}

.card{
background:rgba(255,255,255,0.7);
backdrop-filter:blur(25px);
-webkit-backdrop-filter:blur(25px);
padding:18px;
border-radius:24px;
margin-bottom:16px;
box-shadow:0 8px 30px rgba(0,0,0,0.05);
}

button{
background:#007aff;
color:white;
border:none;
padding:12px 16px;
border-radius:18px;
min-width:60px;
font-weight:600;
}

.task{
display:flex;
justify-content:space-between;
align-items:center;
padding:10px 0;
font-size:17px;
}

input[type="checkbox"]{
appearance:none;
width:52px;
height:32px;
background:#e5e5ea;
border-radius:20px;
position:relative;
transition:.3s;
}

input[type="checkbox"]:checked{
background:#34c759;
}

input[type="checkbox"]::after{
content:"";
width:28px;
height:28px;
background:white;
position:absolute;
top:2px;
left:2px;
border-radius:50%;
transition:.3s;
}

input[type="checkbox"]:checked::after{
transform:translateX(20px);
}

</style>

</head>

<body>

<h1>Ibadah Tracker</h1>

<div class="card">
<div style="display:flex;align-items:center;gap:10px;">
<button onclick="prevDay()">â¬…ï¸</button>
<div style="flex:1;text-align:center;position:relative;">
<div id="displayDate" style="font-weight:600;"></div>
<div id="hijriDate" style="font-size:14px;color:gray;"></div>

<input type="date"
id="datePicker"
onchange="manualPick(this.value)"
style="
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
opacity:0;
cursor:pointer;
z-index:5;
">

</div>
<button onclick="nextDay()">â¡ï¸</button>
</div>
</div>

<div class="card">
<h3>ğŸ“ Daily Tasks</h3>
<div id="taskContainer"></div>
</div>

<div class="card">
<h3>âš™ï¸ Task Settings</h3>

<select id="actionSelect" onchange="handleAction()">
<option value="">Select Action</option>
<option value="add">â• Add Task</option>
<option value="delete">ğŸ—‘ Delete Task</option>
<option value="rename">âœï¸ Rename Task</option>
</select>

<div id="actionArea"></div>

<h4>â˜ï¸ iCloud Backup</h4>

<button onclick="exportBackup()" style="width:100%;margin-bottom:10px;">Export</button>

<input type="file" id="restoreFile" onchange="importBackup()" style="display:none;">
<button onclick="document.getElementById('restoreFile').click()" style="width:100%">Restore</button>

</div>

<div class="card">
<h3>ğŸ”¥ Prayer Streak</h3>
<p id="streakCount">0 Days</p>
</div>

<script>

let currentDate;

let taskList=JSON.parse(localStorage.getItem("taskList"))||[
"Fajr","Dhuhur","Asr","Maghrib","Isha",
"Surah Mulk","Surah Sajdah","Surah Yaseen",
"Surah Rehman","Surah Taghabun","Surah Waqiya"
];

function islamicToday(){
let now=new Date();
let d=new Date(now.getFullYear(),now.getMonth(),now.getDate());
if(now.getHours()<2){d.setDate(d.getDate()-1);}
return d;
}

function formatKey(d){
return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0");
}

function setDate(d){
currentDate=new Date(d);
document.getElementById("displayDate").innerText=
currentDate.toLocaleDateString('en-US',{
weekday:'long',
year:'numeric',
month:'short',
day:'numeric'
});

let hijri=new Intl.DateTimeFormat('en-TN-u-ca-islamic',{
day:'numeric',
month:'long',
year:'numeric'
}).format(currentDate);

document.getElementById("hijriDate").innerText=hijri;
document.getElementById("datePicker").value=formatKey(currentDate);
loadTasks();
}

function manualPick(value){
let p=value.split("-");
setDate(new Date(p[0],p[1]-1,p[2]));
}

function loadTasks(){
let key=formatKey(currentDate);
let saved=JSON.parse(localStorage.getItem(key))||{};
let container=document.getElementById("taskContainer");
container.innerHTML="";
taskList.forEach(task=>{
let div=document.createElement("div");
div.className="task";
div.innerHTML=`
<label>${task}</label>
<input type="ch
