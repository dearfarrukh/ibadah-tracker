<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ibadah Tracker Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="apple-touch-icon" href="icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">

<style>

body{
font-family:-apple-system,BlinkMacSystemFont;
background-image:url("wallpaper.jpg");
background-size:cover;
background-position:center;
background-repeat:no-repeat;
background-attachment:fixed;
margin:0;
padding:20px;
}

.card{
background:rgba(255,255,255,0.6);
backdrop-filter:blur(20px);
padding:18px;
border-radius:22px;
margin-bottom:20px;
}

button{
background:#007aff;
color:white;
border:none;
padding:12px;
border-radius:16px;
width:100%;
}

.task{
display:flex;
justify-content:space-between;
padding:8px 0;
}

input[type="checkbox"]{
width:22px;
height:22px;
accent-color:#007aff;
}

</style>
</head>

<body>

<h1 style="text-align:center;">üìø Ibadah Tracker</h1>

<div class="card">
<h3>üìÖ Select Date</h3>

<div style="display:flex;align-items:center;gap:10px;">

<button onclick="prevDay()" style="width:60px;">‚¨ÖÔ∏è</button>

<input type="date" id="datePicker" style="display:none;">

<div id="displayDate"
style="flex:1;text-align:center;font-weight:600;font-size:18px;">
</div>

<button onclick="nextDay()" style="width:60px;">‚û°Ô∏è</button>

</div>
</div>

<div class="card">
<h3>üìù Daily Tasks</h3>
<div id="taskContainer"></div>
</div>

<div class="card">
<h3>üî• Streak</h3>
<p id="streakCount">0 Days</p>
</div>

<script>

let taskList = JSON.parse(localStorage.getItem("taskList")) || [
"Fajr","Dhuhur","Asr","Maghrib","Isha",
"Surah Mulk","Surah Sajdah","Surah Yaseen",
"Surah Rehman","Surah Taghabun","Surah Waqiya"
];

function getIslamicDay(){

let now = new Date();
let today = new Date();

if(now.getHours() < 2){
today.setDate(today.getDate() - 1);
}

today.setHours(0,0,0,0);
return today;

}

function updateDisplayDate(){

let picker=document.getElementById("datePicker");
let date=new Date(picker.value);

let options={
weekday:'long',
year:'numeric',
month:'short',
day:'numeric'
};

document.getElementById("displayDate").innerText=
date.toLocaleDateString('en-US',options);

}

function loadTasks(){

let container=document.getElementById("taskContainer");
container.innerHTML="";

let date=document.getElementById("datePicker").value;
let saved=JSON.parse(localStorage.getItem(date))||{};

taskList.forEach(task=>{

let div=document.createElement("div");
div.className="task";

div.innerHTML=
`<label>${task}</label>
<input type="checkbox"
${saved[task]?"checked":""}
onchange="toggleTask('${task}',this.checked)">`;

container.appendChild(div);

});

updateStreak();

}

function toggleTask(task,status){

let date=document.getElementById("datePicker").value;
let saved=JSON.parse(localStorage.getItem(date))||{};

saved[task]=status;

localStorage.setItem(date,JSON.stringify(saved));

updateStreak();

}

function prevDay(){

let picker=document.getElementById("datePicker");
let date=new Date(picker.value);

date.setDate(date.getDate()-1);

picker.value=date.toISOString().split("T")[0];

updateDisplayDate();
loadTasks();

}

function nextDay(){

let picker=document.getElementById("datePicker");
let date=new Date(picker.value);

date.setDate(date.getDate()+1);

picker.value=date.toISOString().split("T")[0];

updateDisplayDate();
loadTasks();

}

function updateStreak(){

let streak=0;
let today=getIslamicDay();

for(let i=0;i<365;i++){

let d=new Date(today);
d.setDate(today.getDate()-i);

let key=d.toISOString().split("T")[0];
let saved=JSON.parse(localStorage.getItem(key));

if(saved && Object.values(saved).every(v=>v===true)){
streak++;
}else break;

}

document.getElementById("streakCount").innerText=
streak+" Days";

}

function setCorrectIslamicDay(){

let today=getIslamicDay();

let picker=document.getElementById("datePicker");

let selected=new Date(picker.value || today);
selected.setHours(0,0,0,0);

if(selected.getTime()!==today.getTime()){

picker.value=today.toISOString().split("T")[0];

updateDisplayDate();
loadTasks();

}

}

// Run when open
setCorrectIslamicDay();

// Check every minute (for 2AM auto change)
setInterval(setCorrectIslamicDay,60000);

</script>

</body>
</html>
