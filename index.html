<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ibadah Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" href="icon.png">

<style>
body{
font-family:-apple-system,BlinkMacSystemFont;
background:url('wallpaper.jpg') no-repeat center center fixed;
background-size:cover;
margin:0;
padding:20px;
}

.titleRow{
display:flex;
align-items:center;
gap:8px;
margin:0;
line-height:1;
}

.titleRow span{
line-height:1;
}

h3{
margin:0;
}

.titleRow span{
line-height:1;
}
.card{
background:rgba(255,255,255,0.7);
backdrop-filter:blur(20px);
padding:18px;
border-radius:22px;
margin-bottom:20px;
}

button{
background:#007aff;
color:white;
border:none;
padding:12px;
border-radius:16px;
margin-top:10px;
width:100%;
}

input,select{
width:100%;
padding:12px;
border-radius:16px;
border:none;
margin-top:8px;
}

.task{
display:flex;
justify-content:space-between;
padding:8px 0;
}
</style>

<body>

<h1>ğŸ“¿ Ibadah Tracker</h1>

<div class="card">
<h3>ğŸ“… Select Date</h3>
<input type="date" id="datePicker" onchange="loadTasks()">
</div>

<div class="card">
<div class="titleRow">
<div class="taskIcon"></div>
<h3>Daily Tasks</h3>
</div>
<div id="taskContainer"></div>
</div>

<div class="card">
<h3>âš™ï¸ Task Settings</h3>

<select id="actionSelect" onchange="handleAction()">
<option value="">Select Action</option>
<option value="add">â• Add Task</option>
<option value="delete">ğŸ—‘ Delete Task</option>
<option value="rename">âœï¸ Rename Task</option>
</select>

<div id="actionArea"></div>

<h4>â˜ï¸ Backup</h4>
<button onclick="exportBackup()">Export Backup</button>
<input type="file" id="restoreFile" onchange="importBackup()" style="display:none;">
<button onclick="document.getElementById('restoreFile').click()">Restore Backup</button>

</div>

<div class="card">
<h3>ğŸ”¥ Streak</h3>
<p id="streakCount">0 Days</p>
</div>

<div class="card">
<h3>ğŸ“Š Monthly Report</h3>
<p id="monthlyReport"></p>
</div>

<script>

let taskList = JSON.parse(localStorage.getItem("taskList")) || [
"Fajr","Dhuhur","Asr","Maghrib","Isha"
];

document.getElementById("datePicker").valueAsDate = new Date();

function getSelectedDate(){
return document.getElementById("datePicker").value;
}

function loadTasks(){
let container=document.getElementById("taskContainer");
container.innerHTML="";
let date=getSelectedDate();
let saved=JSON.parse(localStorage.getItem(date))||{};

taskList.forEach(task=>{
let div=document.createElement("div");
div.className="task";
div.innerHTML=`<label>${task}</label>
<input type="checkbox" ${saved[task]?"checked":""}
onchange="toggleTask('${task}',this.checked)">`;
container.appendChild(div);
});

updateStreak();
updateMonthlyReport();
}

function toggleTask(task,status){
let saved=JSON.parse(localStorage.getItem(getSelectedDate()))||{};
saved[task]=status;
localStorage.setItem(getSelectedDate(),JSON.stringify(saved));
updateStreak();
updateMonthlyReport();
}

function handleAction(){
let action=document.getElementById("actionSelect").value;
let area=document.getElementById("actionArea");
area.innerHTML="";

if(action==="add"){
area.innerHTML=`<input type="text" id="newTaskName" placeholder="Task name">
<button onclick="confirmAdd()">Add</button>`;
}

if(action==="delete"){
let options=taskList.map(t=>`<option value="${t}">${t}</option>`).join("");
area.innerHTML=`<select id="deleteTaskSelect">${options}</select>
<button onclick="confirmDelete()">Delete</button>`;
}

if(action==="rename"){
let options=taskList.map(t=>`<option value="${t}">${t}</option>`).join("");
area.innerHTML=`<select id="renameSelect">${options}</select>
<input type="text" id="renameInput" placeholder="New name">
<button onclick="confirmRename()">Rename</button>`;
}
}

function confirmAdd(){
let name=document.getElementById("newTaskName").value.trim();
if(name && !taskList.includes(name)){
taskList.push(name);
localStorage.setItem("taskList",JSON.stringify(taskList));
loadTasks();
}
}

function confirmDelete(){
let task=document.getElementById("deleteTaskSelect").value;
taskList=taskList.filter(t=>t!==task);
localStorage.setItem("taskList",JSON.stringify(taskList));
loadTasks();
}

function confirmRename(){
let oldName=document.getElementById("renameSelect").value;
let newName=document.getElementById("renameInput").value.trim();
if(newName){
taskList=taskList.map(t=>t===oldName?newName:t);
localStorage.setItem("taskList",JSON.stringify(taskList));
loadTasks();
}
}

function updateStreak(){
let streak=0;
let today=new Date();

for(let i=0;i<365;i++){
let date=new Date();
date.setDate(today.getDate()-i);
let key=date.toISOString().split("T")[0];
let saved=JSON.parse(localStorage.getItem(key));
if(saved && Object.values(saved).every(v=>v===true)){
streak++;
}else break;
}

document.getElementById("streakCount").innerText=streak+" Days";
}

function updateMonthlyReport(){
let today=new Date();
let month=today.getMonth();
let year=today.getFullYear();
let completed=0;

for(let i=1;i<=31;i++){
let date=new Date(year,month,i);
if(date.getMonth()!==month) break;
let key=date.toISOString().split("T")[0];
let saved=JSON.parse(localStorage.getItem(key));
if(saved && Object.values(saved).every(v=>v===true)){
completed++;
}
}

document.getElementById("monthlyReport").innerText=
"Perfect Days This Month: "+completed;
}

function exportBackup(){
let data={taskList:taskList,storage:{}};
for(let i=0;i<localStorage.length;i++){
let key=localStorage.key(i);
data.storage[key]=localStorage.getItem(key);
}
let blob=new Blob([JSON.stringify(data)],{type:"application/json"});
let url=URL.createObjectURL(blob);
let a=document.createElement("a");
a.href=url;
a.download="ibadah-backup.json";
a.click();
}

function importBackup(){
let file=document.getElementById("restoreFile").files[0];
let reader=new FileReader();
reader.onload=function(e){
let data=JSON.parse(e.target.result);
localStorage.clear();
for(let key in data.storage){
localStorage.setItem(key,data.storage[key]);
}
location.reload();
};
reader.readAsText(file);
}

loadTasks();

</script>

</body>
</html>





